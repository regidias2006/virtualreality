<!DOCTYPE html>
<!-- AR.js by @jerome_etienne - github: https://github.com/jeromeetienne/ar.js - info: https://medium.com/arjs/augmented-reality-in-10-lines-of-html-4e193ea9fdbf -->
<script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
<script src="script.js"></script>
<script src="https://raw.githack.com/jeromeetienne/AR.js/1.6.0/aframe/build/aframe-ar.js"></script>

<body >
  
  <a-scene id="myscene" embedded arjs="sourceType: webcam; " >
                                 
    <a-marker  preset="hiro" type="pattern"  markerhandler emitevents="true" cursor="rayOrigin: mouse; fuse:false" id="animated-marker">
  
     <a-image id="UserDetailAvatar" src="https://img.buzzfeed.com/buzzfeed-static/static/2018-06/19/17/asset/buzzfeed-prod-web-04/sub-buzz-9154-1529444543-1.jpg" 
                rotation="-90 0 0" position="0 0.2 0" ></a-image>
    
      <a-text id="dynamictext" value="Users" rotation="-90 0 0" position="-1.6 0.1 -0.35" color="blue" wrap-count="80"></a-text>

    
    </a-marker>
    
    <a-entity camera></a-entity>
  </a-scene>
  
  <script>
    function showUsers(userspageId) {
        var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {

                  //get rest-api response
                  var mytext = this.responseText;
                  var obj = JSON.parse(mytext);

                  
                  var vertical=0;
                  var element = document.getElementById("animated-marker");
                  
                  //create names and images
                  for(let dt in obj.data){
                    console.log( obj.data[dt].first_name );
                    
                    //calculate position for text
                    var name=obj.data[dt].first_name;
                    vertical=vertical+0.3;
                    var position="-1.5 0.1 "+vertical;
                    
                    
                 //clean if exist and create username text
                 var existing_text= document.getElementById("userNameText"+dt);
                    if(existing_text){
                       element.removeChild(existing_text);
                    }
                 var child = document.createElement("a-text");
                 child.setAttribute("id","userNameText"+dt)
                 child.setAttribute("value", name);
                 child.setAttribute("position",position);
                 child.setAttribute("rotation","-90 0 0");
                 child.setAttribute("wrap-count","90");

                  //calculate position for image                    
                var image_avatar=obj.data[dt].avatar 
                var img_position="-1.8 0.1 "+vertical;   
                 
                 //clean if exist and create user image  
                 var existing_image= document.getElementById("userAvatar"+dt);
                    if(existing_image){
                       element.removeChild(existing_image);
                    }
                 var image_child = document.createElement("a-image");
                 image_child.setAttribute("id","userAvatar"+dt)
                 image_child .setAttribute("src", image_avatar);
                 image_child .setAttribute("height","0.25" );
                 image_child .setAttribute("width","0.25" );
                 image_child .setAttribute("position",img_position);
                 image_child .setAttribute("rotation","-90 0 0");
                 image_child.setAttribute("onclick","showUserDetail("+obj.data[dt].id+")");
                  
    
                  element.appendChild(child);
                  element.appendChild(image_child);
             
            }

                }
            };


    xhttp.open("GET", "https://reqres.in/api/users?page="+userspageId, true)
    xhttp.send();  
}


function showUserDetail(userId) {
  
  var userDetailResponse="unedited text";
 var xhttp = new XMLHttpRequest();
           xhttp.onreadystatechange = function() {
               if (this.readyState == 4 && this.status == 200) {

                 
                 userDetailResponse = this.responseText;
                   
                 var obj = JSON.parse(userDetailResponse);

                 
                 
                 var userNameText = document.getElementById("userDetailName");
                  userNameText.setAttribute("value", obj.data.first_name); 
                 
                 var userSurnameText = document.getElementById("userDetailSurname");
                  userSurnameText.setAttribute("value", obj.data.last_name); 
                 
                 
                  var userEmailText = document.getElementById("userDetailEmail");
                  userEmailText.setAttribute("value", obj.data.email);
                 
                 var userAvatarImage = document.getElementById("UserDetailAvatar");
                  userAvatarImage.setAttribute("src", obj.data.avatar);

               
                 
                 //mydynamictext.setAttribute("value", mytext);
               }
           };
 
   xhttp.open("GET", "https://reqres.in/api/users/"+userId, true)
 xhttp.send();  
 
}

  </script>

</body>